<!doctype html><html lang="en" ><head> <script async src="https://www.googletagmanager.com/gtag/js?id=G-LXECFRDHS1"></script> <script> window.dataLayer = window.dataLayer || []; function gtag() { dataLayer.push(arguments); } gtag('js', new Date()); gtag('config', 'G-LXECFRDHS1'); </script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.3.3" /><meta property="og:title" content="AWS Kinesis Agent configuration and setup for Data Streaming to the Cloud | by Roman Tsypuk" /><meta name="author" content="Roman Tsypuk" /><meta property="og:locale" content="en" /><meta name="description" content="Amazon Kinesis Agent is a powerful tool that helps you collect, process, and transfer data in real-time to AWS services like Amazon Kinesis Data Streams, Amazon Kinesis Data Firehose, and Amazon CloudWatch. In this guide, we’ll walk you through the steps to set up and configure the AWS Kinesis Agent on an Ubuntu OS." /><meta property="og:description" content="Amazon Kinesis Agent is a powerful tool that helps you collect, process, and transfer data in real-time to AWS services like Amazon Kinesis Data Streams, Amazon Kinesis Data Firehose, and Amazon CloudWatch. In this guide, we’ll walk you through the steps to set up and configure the AWS Kinesis Agent on an Ubuntu OS." /><meta property="twitter:description" content="Amazon Kinesis Agent is a powerful tool that helps you collect, process, and transfer data in real-time to AWS services like Amazon Kinesis Data Streams, Amazon Kinesis Data Firehose, and Amazon CloudWatch. In this guide, we’ll walk you through the steps to set up and configure the AWS Kinesis Agent on an Ubuntu OS." /><link rel="canonical" href="https://tsypuk.github.io/posts/2023/10/17/kineses-agent.html" /><meta property="og:url" content="https://tsypuk.github.io/posts/2023/10/17/kineses-agent.html" /><meta property="og:site_name" content="Engineer’s Notes | Roman Tsypuk" /><meta property="og:image" content="https://tsypuk.github.io/images/banners/1200/pexels-pixabay-531552.jpeg" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2023-10-17T17:00:00+03:00" /><meta name="publish_date" property="og:publish_date" content="2023-10-17T17:00:00+03:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://tsypuk.github.io/images/banners/1200/pexels-pixabay-531552.jpeg" /><meta property="twitter:title" content="AWS Kinesis Agent configuration and setup for Data Streaming to the Cloud | by Roman Tsypuk" /><meta name="twitter:site" content="@roman_tsypuk" /><meta name="twitter:creator" content="@roman_tsypuk" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Roman Tsypuk"},"dateModified":"2024-02-25T18:38:06+02:00","datePublished":"2023-10-17T17:00:00+03:00","description":"Amazon Kinesis Agent is a powerful tool that helps you collect, process, and transfer data in real-time to AWS services like Amazon Kinesis Data Streams, Amazon Kinesis Data Firehose, and Amazon CloudWatch. In this guide, we’ll walk you through the steps to set up and configure the AWS Kinesis Agent on an Ubuntu OS.","headline":"AWS Kinesis Agent configuration and setup for Data Streaming to the Cloud","image":"https://tsypuk.github.io/images/banners/1200/pexels-pixabay-531552.jpeg","mainEntityOfPage":{"@type":"WebPage","@id":"https://tsypuk.github.io/posts/2023/10/17/kineses-agent.html"},"url":"https://tsypuk.github.io/posts/2023/10/17/kineses-agent.html"}</script><title>AWS Kinesis Agent configuration and setup for Data Streaming to the Cloud | Engineer's Notes</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Engineer's Notes"><meta name="application-name" content="Engineer's Notes"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.32.2/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css"> <script src="/assets/js/dist/theme.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/en.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js,npm/tocbot@4.32.2/dist/tocbot.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.min.js?baseurl=&register=" ></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-LXECFRDHS1"></script> <script> document.addEventListener('DOMContentLoaded', () => { window.dataLayer = window.dataLayer || []; function gtag() { dataLayer.push(arguments); } gtag('js', new Date()); gtag('config', 'G-LXECFRDHS1'); }); </script><body><aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end"><header class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"><img src="/images/avatar/rtsypuk.jpg" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a> <a class="site-title d-block" href="/">Engineer's Notes</a><p class="site-subtitle fst-italic mb-0">Cloud, Infrastructure, Architecture, Networking</p></header><nav class="flex-column flex-grow-1 w-100 ps-0"><ul class="nav"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories.html" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags.html" class="nav-link"> <i class="fa-fw fas fa-tag"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archived_posts.html" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/roman_tsypuk.html" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a></ul></nav><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <button type="button" class="btn btn-link nav-link" aria-label="Switch Mode" id="mode-toggle"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/tsypuk" aria-label="github" target="_blank" rel="noopener noreferrer" > <i class="fab fa-github"></i> </a> <a href="https://twitter.com/roman_tsypuk" aria-label="twitter" target="_blank" rel="noopener noreferrer" > <i class="fab fa-twitter"></i> </a> <a href="https://www.linkedin.com/in/roman-tsypuk" aria-label="linkedin" target="_blank" rel="noopener noreferrer" > <i class="fab fa-linkedin"></i> </a> <a href="javascript:location.href = 'mailto:' + ['tsypuk_conf','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a></div></aside><div id="main-wrapper" class="d-flex justify-content-center"><div class="container d-flex flex-column px-xxl-5"><header id="topbar-wrapper" aria-label="Top Bar"><div id="topbar" class="d-flex align-items-center justify-content-between px-lg-3 h-100" ><nav id="breadcrumb" aria-label="Breadcrumb"> <span> <a href="/">Home</a> </span> <span>AWS Kinesis Agent configuration and setup for Data Streaming to the Cloud</span></nav><button type="button" id="sidebar-trigger" class="btn btn-link" aria-label="Sidebar"> <i class="fas fa-bars fa-fw"></i> </button><div id="topbar-title"> Post</div><button type="button" id="search-trigger" class="btn btn-link" aria-label="Search"> <i class="fas fa-search fa-fw"></i> </button> <search id="search" class="align-items-center ms-3 ms-lg-0"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </search> <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button></div></header><div class="row flex-grow-1"><main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4"><article class="px-1" data-toc="true"><header><h1 data-toc-skip>AWS Kinesis Agent configuration and setup for Data Streaming to the Cloud</h1><div class="post-meta text-muted"> <span> Posted <time data-ts="1697551200" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Oct 17, 2023 </time> </span> <span> Updated <time data-ts="1708879086" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Feb 25, 2024 </time> </span><div class="mt-3 mb-3"> <a href="/images/banners/1200/pexels-pixabay-531552.jpeg" class="popup img-link preview-img shimmer"><img src="/images/banners/1200/pexels-pixabay-531552.jpeg" alt="Preview Image" width="1200" height="630" loading="lazy"></a></div><div class="d-flex justify-content-between"> <span> By <em> <a href="https://www.linkedin.com/in/roman-tsypuk">Roman Tsypuk</a> </em> </span><div> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="1014 words" > <em>5 min</em> read</span></div></div></div></header><div id="toc-bar" class="d-flex align-items-center justify-content-between invisible"> <span class="label text-truncate">AWS Kinesis Agent configuration and setup for Data Streaming to the Cloud</span> <button type="button" class="toc-trigger btn me-1"> <i class="fa-solid fa-list-ul fa-fw"></i> </button></div><button id="toc-solo-trigger" type="button" class="toc-trigger btn btn-outline-secondary btn-sm"> <span class="label ps-2 pe-1">Contents</span> <i class="fa-solid fa-angle-right fa-fw"></i> </button> <dialog id="toc-popup" class="p-0"><div class="header d-flex flex-row align-items-center justify-content-between"><div class="label text-truncate py-2 ms-4">AWS Kinesis Agent configuration and setup for Data Streaming to the Cloud</div><button id="toc-popup-close" type="button" class="btn mx-1 my-1 opacity-75"> <i class="fas fa-close"></i> </button></div><div id="toc-popup-content" class="px-4 py-3 pb-4"></div></dialog><div class="content"><h2 id="abstract"><span class="me-2">Abstract</span><a href="#abstract" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Amazon Kinesis Agent is a powerful tool that helps you collect, process, and transfer data in real-time to AWS services like Amazon Kinesis Data Streams, Amazon Kinesis Data Firehose, and Amazon CloudWatch. In this guide, we’ll walk you through the steps to set up and configure the AWS Kinesis Agent on an Ubuntu OS.</p><h2 id="target-infrastructure"><span class="me-2">Target Infrastructure</span><a href="#target-infrastructure" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><a href="/images/posts/kinesis/infra.png" class="popup img-link shimmer"><img src="/images/posts/kinesis/infra.png" alt="infra.png" loading="lazy"></a></p><h2 id="install-kinesis-agent"><span class="me-2">Install kinesis agent</span><a href="#install-kinesis-agent" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Depending on your operating system, there are two paths to consider: a shorter, automated setup process and a longer one that involves manual compilation. If your operating system provides a pre-packaged version of the Kinesis agent in its repository, you can set it up automatically. Otherwise, you’ll need to build it from source manually. <code class="language-plaintext highlighter-rouge">Centos</code> installation is straight forward:</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
</pre><td class="rouge-code"><pre><span class="o">[</span>cloudshell-user@ip-xx-xx-xx-xx ~]<span class="nv">$ </span><span class="nb">sudo </span>yum <span class="nb">install </span>aws-kinesis-agent

Installed:
  aws-kinesis-agent.noarch 0:2.0.8-1.amzn2

Dependency Installed:
  alsa-lib.x86_64 0:1.1.4.1-2.amzn2                              atk.x86_64 0:2.22.0-3.amzn2.0.2                                         avahi-libs.x86_64 0:0.6.31-20.amzn2.0.2
  cairo.x86_64 0:1.15.12-4.amzn2                                 copy-jdk-configs.noarch 0:3.3-10.amzn2                                  cups-libs.x86_64 1:1.6.3-51.amzn2.0.3
  dejavu-fonts-common.noarch 0:2.33-6.amzn2                      dejavu-sans-fonts.noarch 0:2.33-6.amzn2                                 fontconfig.x86_64 0:2.13.0-4.3.amzn2
  fontpackages-filesystem.noarch 0:1.44-8.amzn2                  freetype.x86_64 0:2.8-14.amzn2.1.1                                      fribidi.x86_64 0:1.0.2-1.amzn2.1.2
  gdk-pixbuf2.x86_64 0:2.36.12-3.amzn2                           giflib.x86_64 0:4.1.6-9.amzn2.0.2                                       graphite2.x86_64 0:1.3.10-1.amzn2.0.2
  gtk-update-icon-cache.x86_64 0:3.22.30-3.amzn2                 gtk2.x86_64 0:2.24.31-1.amzn2.0.2                                       harfbuzz.x86_64 0:1.7.5-2.amzn2
  hicolor-icon-theme.noarch 0:0.12-7.amzn2                       hwdata.x86_64 0:0.252-9.3.amzn2                                         jasper-libs.x86_64 0:1.900.1-33.amzn2.0.1
  java-1.8.0-openjdk.x86_64 1:1.8.0.382.b05-1.amzn2.0.1          java-1.8.0-openjdk-headless.x86_64 1:1.8.0.382.b05-1.amzn2.0.1          javapackages-tools.noarch 0:3.4.1-11.amzn2
  jbigkit-libs.x86_64 0:2.0-11.amzn2.0.2                         libICE.x86_64 0:1.0.9-9.amzn2.0.2                                       libSM.x86_64 0:1.2.2-2.amzn2.0.2
  libX11.x86_64 0:1.6.7-3.amzn2.0.3                              libX11-common.noarch 0:1.6.7-3.amzn2.0.3                                libXau.x86_64 0:1.0.8-2.1.amzn2.0.2
  libXcomposite.x86_64 0:0.4.4-4.1.amzn2.0.2                     libXcursor.x86_64 0:1.1.15-1.amzn2                                      libXdamage.x86_64 0:1.1.4-4.1.amzn2.0.2
  libXext.x86_64 0:1.3.3-3.amzn2.0.2                             libXfixes.x86_64 0:5.0.3-1.amzn2.0.2                                    libXft.x86_64 0:2.3.2-2.amzn2.0.2
  libXi.x86_64 0:1.7.9-1.amzn2.0.2                               libXinerama.x86_64 0:1.1.3-2.1.amzn2.0.2                                libXrandr.x86_64 0:1.5.1-2.amzn2.0.3
  libXrender.x86_64 0:0.9.10-1.amzn2.0.2                         libXtst.x86_64 0:1.2.3-1.amzn2.0.2                                      libXxf86vm.x86_64 0:1.1.4-1.amzn2.0.2
  libdrm.x86_64 0:2.4.97-2.amzn2                                 libfontenc.x86_64 0:1.1.3-3.amzn2.0.2                                   libglvnd.x86_64 1:1.0.1-0.1.git5baa1e5.amzn2.0.1
  libglvnd-egl.x86_64 1:1.0.1-0.1.git5baa1e5.amzn2.0.1           libglvnd-glx.x86_64 1:1.0.1-0.1.git5baa1e5.amzn2.0.1                    libjpeg-turbo.x86_64 0:2.0.90-2.amzn2.0.6
  libpciaccess.x86_64 0:0.14-1.amzn2                             libpng.x86_64 2:1.5.13-8.amzn2.0.5                                      libthai.x86_64 0:0.1.14-9.amzn2.0.2
  libtiff.x86_64 0:4.0.3-35.amzn2.0.14                           libwayland-client.x86_64 0:1.17.0-1.amzn2.0.1                           libwayland-server.x86_64 0:1.17.0-1.amzn2.0.1
  libxcb.x86_64 0:1.12-1.amzn2.0.2                               libxshmfence.x86_64 0:1.2-1.amzn2.0.2                                   libxslt.x86_64 0:1.1.28-6.amzn2
  lksctp-tools.x86_64 0:1.0.17-2.amzn2.0.2                       log4j-cve-2021-44228-hotpatch.noarch 0:1.3-7.amzn2                      mesa-libEGL.x86_64 0:18.3.4-5.amzn2.0.1
  mesa-libGL.x86_64 0:18.3.4-5.amzn2.0.1                         mesa-libgbm.x86_64 0:18.3.4-5.amzn2.0.1                                 mesa-libglapi.x86_64 0:18.3.4-5.amzn2.0.1
  pango.x86_64 0:1.42.4-4.amzn2                                  pcsc-lite-libs.x86_64 0:1.8.8-7.amzn2                                   pixman.x86_64 0:0.34.0-1.amzn2.0.2
  pkgconfig.x86_64 1:0.27.1-4.amzn2.0.2                          python-javapackages.noarch 0:3.4.1-11.amzn2                             python-lxml.x86_64 0:3.2.1-4.amzn2.0.4
  ttmkfdir.x86_64 0:3.0.9-42.amzn2.0.2                           tzdata-java.noarch 0:2023c-1.amzn2.0.1                                  xorg-x11-font-utils.x86_64 1:7.5-21.amzn2
  xorg-x11-fonts-Type1.noarch 0:7.5-9.amzn2

Complete!
</pre></table></code></div></div><p>If you’re using Ubuntu, we’ll need to take an additional step: building the aws-kinesis-agent manually and then installing it. Please follow these instructions:</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre><td class="rouge-code"><pre>apt <span class="nb">install </span>git
git clone https://github.com/awslabs/amazon-kinesis-agent.git
<span class="nb">sudo</span> ./setup <span class="nt">--install</span>

BUILD SUCCESSFUL
Total <span class="nb">time</span>: 44 seconds
Configuration file installed at: /etc/aws-kinesis/agent.json
Configuration details:
<span class="o">{</span>
  <span class="s2">"cloudwatch.emitMetrics"</span>: <span class="nb">true</span>,
  <span class="s2">"kinesis.endpoint"</span>: <span class="s2">""</span>,
  <span class="s2">"firehose.endpoint"</span>: <span class="s2">""</span>,

  <span class="s2">"flows"</span>: <span class="o">[</span>
    <span class="o">{</span>
      <span class="s2">"filePattern"</span>: <span class="s2">"/tmp/app.log*"</span>,
      <span class="s2">"kinesisStream"</span>: <span class="s2">"yourkinesisstream"</span>,
      <span class="s2">"partitionKeyOption"</span>: <span class="s2">"RANDOM"</span>
    <span class="o">}</span>,
    <span class="o">{</span>
      <span class="s2">"filePattern"</span>: <span class="s2">"/tmp/app.log*"</span>,
      <span class="s2">"deliveryStream"</span>: <span class="s2">"yourdeliverystream"</span>
    <span class="o">}</span>
  <span class="o">]</span>
<span class="o">}</span>
Amazon Kinesis Agent is installed successfully.
Your installation has completed!
</pre></table></code></div></div><p>aws-kinesis-agent log file will be found at: /var/log/aws-kinesis-agent</p><p>Control <code class="language-plaintext highlighter-rouge">aws-kinesis-agent</code> service:</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>service aws-kinesis-agent <span class="o">[</span>start|stop|restart|status]
</pre></table></code></div></div><p>To make the agent automatically start at system startup, type:</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>chkconfig aws-kinesis-agent on
</pre></table></code></div></div><h2 id="prepare-logs-for-ingestion"><span class="me-2">Prepare Logs for ingestion</span><a href="#prepare-logs-for-ingestion" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo mkdir</span> /var/log/kinesis
</pre></table></code></div></div><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">cd</span> /etc/aws-kinesis/
<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-l</span>
total 5
drwxr-xr-x 2 root root 1024 Sep  6  2022 agent.d
<span class="nt">-rw-r--r--</span> 1 root root  338 Sep  6  2022 agent.json
<span class="nt">-rw-r--r--</span> 1 root root 2160 Sep  6  2022 log4j.xml
</pre></table></code></div></div><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>nano agent.json
</pre></table></code></div></div><p>We will be using <code class="language-plaintext highlighter-rouge">aws-kinesis-agent</code> with <code class="language-plaintext highlighter-rouge">Kinesis Firehose</code> but not a <code class="language-plaintext highlighter-rouge">Kinesis Data Stream</code>, so let’s update configuration to the following (but same agent can work with multiple sources and sinks):</p><p>Additionally, the agent provides essential Amazon CloudWatch metrics for streamlined monitoring and troubleshooting of the entire streaming process (but for this setup we will set them to <code class="language-plaintext highlighter-rouge">FALSE</code>)</p><div class="language-json highlighter-rouge"><div class="code-header"> <span data-label-text="JSON"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre><span class="p">{</span><span class="w">
  </span><span class="nl">"cloudwatch.emitMetrics"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="nl">"kinesis.endpoint"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
  </span><span class="nl">"firehose.endpoint"</span><span class="p">:</span><span class="w"> </span><span class="s2">"firehose.eu-west-1.amazonaws.com"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"awsAccessKeyId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ADD_KEY_HERE"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"awsSecretAccessKey"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ADD_SECRET_HERE"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"flows"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"filePattern"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/var/log/kinesis/*.log*"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"deliveryStream"</span><span class="p">:</span><span class="w"> </span><span class="s2">"terraform-kinesis-firehose-logs-s3-stream"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></table></code></div></div><p>Update the following parameters in configuration:</p><div class="table-wrapper"><table><thead><tr><th>Param<th>Description<tbody><tr><td>firehose.endpoint<td>based on region you are have provisioned firehose it will have naming firehose.<region>.amazonaws.com</region><tr><td>filePattern<td>location of logs you want to monitor and push to the cloud<tr><td>deliveryStream<td>name of Firehose Delivery Stream <code class="language-plaintext highlighter-rouge">terraform-kinesis-firehose-logs-s3-stream</code> from aws console</table></div><p>If you are running <code class="language-plaintext highlighter-rouge">aws-kinesis-agent</code> from EC2 instance in AWS - than instead of entering creds to configuration file, just attach IAM Role. If you are running from on-prem DC than AccessKey, SecretAccessKey should be provisioned in <code class="language-plaintext highlighter-rouge">aws-kinesis-agent</code> json config.</p><p>Now <code class="language-plaintext highlighter-rouge">aws-kinesis-agent</code> monitors the logs folder and once new records are appended it will ingest them to the Cloud.</p><h2 id="checking-the-results-of-aws-kinesis-agent"><span class="me-2">Checking the results of aws-kinesis-agent</span><a href="#checking-the-results-of-aws-kinesis-agent" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>With the AWS Kinesis Agent successfully installed, you’re now ready to start streaming data seamlessly into your AWS environment. Once new records are appended to <code class="language-plaintext highlighter-rouge">logs</code>, kinesis agent starts operating them, and you can track the activity under <code class="language-plaintext highlighter-rouge">kinesis-agent</code> logs:</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="nb">tail</span> <span class="nt">-f</span> /var/log/aws-kinesis-agent/aws-kinesis-agent.log
2023-10-18 16:40:38.902+0000  <span class="o">(</span>Agent.MetricsEmitter RUNNING<span class="o">)</span> com.amazon.kinesis.streaming.agent.Agent <span class="o">[</span>INFO] Agent: Progress: 30000 records parsed <span class="o">(</span>2519250 bytes<span class="o">)</span>, and 30000 records sent successfully to destinations. Uptime: 13200218ms
2023-10-18 16:41:08.889+0000  <span class="o">(</span>FileTailer[fh:terraform-kinesis-firehose-logs-s3-stream:/var/log/data/<span class="k">*</span>.log].MetricsEmitter RUNNING<span class="o">)</span> com.amazon.kinesis.streaming.agent.tailing.FileTailer <span class="o">[</span>INFO] FileTailer[fh:terraform-kinesis-firehose-logs-s3-stream:/var/log/data/<span class="k">*</span>.log]: Tailer Progress: Tailer has parsed 30000 records <span class="o">(</span>2519250 bytes<span class="o">)</span>, transformed 0 records, skipped 0 records, and has successfully sent 30000 records to destination.
2023-10-18 16:41:08.902+0000  <span class="o">(</span>Agent.MetricsEmitter RUNNING<span class="o">)</span> com.amazon.kinesis.streaming.agent.Agent <span class="o">[</span>INFO] Agent: Progress: 30000 records parsed <span class="o">(</span>2519250 bytes<span class="o">)</span>, and 30000 records sent successfully to destinations. Uptime: 13230218ms
2023-10-18 16:41:38.889+0000  <span class="o">(</span>FileTailer[fh:terraform-kinesis-firehose-logs-s3-stream:/var/log/data/<span class="k">*</span>.log].MetricsEmitter RUNNING<span class="o">)</span> com.amazon.kinesis.streaming.agent.tailing.FileTailer <span class="o">[</span>INFO] FileTailer[fh:terraform-kinesis-firehose-logs-s3-stream:/var/log/data/<span class="k">*</span>.log]: Tailer Progress: Tailer has parsed 30000 records <span class="o">(</span>2519250 bytes<span class="o">)</span>, transformed 0 records, skipped 0 records, and has successfully sent 30000 records to destination.
2023-10-18 16:41:38.902+0000  <span class="o">(</span>Agent.MetricsEmitter RUNNING<span class="o">)</span> com.amazon.kinesis.streaming.agent.Agent <span class="o">[</span>INFO] Agent: Progress: 30000 records parsed <span class="o">(</span>2519250 bytes<span class="o">)</span>, and 30000 records sent successfully to destinations. Uptime: 13260218ms<span class="sb">```</span>
</pre></table></code></div></div><h2 id="conclusion"><span class="me-2">Conclusion</span><a href="#conclusion" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Agent is a Java-based application designed for seamless data collection and transmission to Kinesis Data Streams. It efficiently monitors specified files, ensuring timely delivery of new data to your stream. With built-in features like file rotation, checkpointing, and automatic retries in case of failures, it guarantees reliable data delivery.</p><p>Because the <code class="language-plaintext highlighter-rouge">kinesis-agent</code> is built in Java, it’s important to consider allocating sufficient heap memory for the JVM. Prior to running the agent, ensure your machine has enough free resources and review the configuration accordingly.</p><p>In the next post <a href="/posts/2023/10/18/kineses-firehose.html">Connecting Kinesis Firehose DataStream with aws-kinesis-agent to ingest Log Data into AWS S3</a> we will configure Cloud side of <code class="language-plaintext highlighter-rouge">Kinesis Firehose</code> to receive data from <code class="language-plaintext highlighter-rouge">kinesis-agent</code> and persist to <code class="language-plaintext highlighter-rouge">S3</code>.</p><h2 id="references-links"><span class="me-2">References (Links)</span><a href="#references-links" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>https://docs.aws.amazon.com/streams/latest/dev/writing-with-agents.html<li>https://docs.aws.amazon.com/streams/latest/dev/kinesis-tutorial-cli-installation.html<li><a href="/posts/2023/10/18/kineses-firehose.html">Connecting Kinesis Firehose DataStream with aws-kinesis-agent to ingest Log Data into AWS S3</a></ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href="/categories/aws/">aws</a>, <a href="/categories/kinesis/">kinesis</a>, <a href="/categories/agent/">agent</a>, <a href="/categories/s3/">s3</a>, <a href="/categories/firehose/">firehose</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/aws/" class="post-tag no-text-decoration" >aws</a> <a href="/tags/kinesis/" class="post-tag no-text-decoration" >kinesis</a> <a href="/tags/agent/" class="post-tag no-text-decoration" >agent</a> <a href="/tags/s3/" class="post-tag no-text-decoration" >s3</a> <a href="/tags/firehose/" class="post-tag no-text-decoration" >firehose</a></div><div class=" post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2 " ><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper d-flex align-items-center"> <span class="share-label text-muted">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=AWS%20Kinesis%20Agent%20configuration%20and%20setup%20for%20Data%20Streaming%20to%20the%20Cloud%20-%20Engineer's%20Notes&url=https%3A%2F%2Ftsypuk.github.io%2Fposts%2F2023%2F10%2F17%2Fkineses-agent.html" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=AWS%20Kinesis%20Agent%20configuration%20and%20setup%20for%20Data%20Streaming%20to%20the%20Cloud%20-%20Engineer's%20Notes&u=https%3A%2F%2Ftsypuk.github.io%2Fposts%2F2023%2F10%2F17%2Fkineses-agent.html" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Ftsypuk.github.io%2Fposts%2F2023%2F10%2F17%2Fkineses-agent.html&text=AWS%20Kinesis%20Agent%20configuration%20and%20setup%20for%20Data%20Streaming%20to%20the%20Cloud%20-%20Engineer's%20Notes" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Ftsypuk.github.io%2Fposts%2F2023%2F10%2F17%2Fkineses-agent.html" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Linkedin" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <button id="copy-link" aria-label="Copy link" class="btn small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > <i class="fa-fw fas fa-link pe-none fs-6"></i> </button> </span></div></div></div></article></main><aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted"><div class="access"><section id="access-lastmod"><h2 class="panel-heading">Recently Updated</h2><ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/posts/2025/09/26/multiagnet-n8n-bedrock.html">Orchestrating AI multi-agent infrastructure with AWS Bedrock, OpenAI and n8n</a><li class="text-truncate lh-lg"> <a href="/posts/2025/07/20/elastic-cache-vector.html">Amazon ElastiCache Redis as a Vector Embeddings Storage for Semantic Search in AWS Community Blog posts</a><li class="text-truncate lh-lg"> <a href="/posts/2025/09/17/duckdb-s3.html">Running analytics queries from your machine with Zero-BigData stack needed on top of AWS S3(compressed JSON, Parquet, csv) or other DataSources</a><li class="text-truncate lh-lg"> <a href="/posts/2023/10/02/dynamo-design.html">DynamoDB Table Design Principles - NoSQL Modeling</a><li class="text-truncate lh-lg"> <a href="/posts/2023/10/04/dynamo-one-to-many.html">DynamoDB Table Design Principles - One-To-Many Relationships in NoSQL</a></ul></section><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/aws/">aws</a> <a class="post-tag btn btn-outline-primary" href="/tags/dynamodb/">dynamodb</a> <a class="post-tag btn btn-outline-primary" href="/tags/git/">git</a> <a class="post-tag btn btn-outline-primary" href="/tags/security/">security</a> <a class="post-tag btn btn-outline-primary" href="/tags/s3/">s3</a> <a class="post-tag btn btn-outline-primary" href="/tags/ecs/">ecs</a> <a class="post-tag btn btn-outline-primary" href="/tags/network/">network</a> <a class="post-tag btn btn-outline-primary" href="/tags/cli/">cli</a> <a class="post-tag btn btn-outline-primary" href="/tags/fargate/">fargate</a> <a class="post-tag btn btn-outline-primary" href="/tags/firehose/">firehose</a></div></section></div><div class="toc-border-cover z-3"></div><section id="toc-wrapper" class="invisible position-sticky ps-0 pe-4 pb-4"><h2 class="panel-heading ps-3 pb-2 mb-0">Contents</h2><nav id="toc"></nav></section></aside></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4"><aside id="related-posts" aria-labelledby="related-label"><h3 class="mb-4" id="related-label">Further Reading</h3><nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><article class="col"> <a href="/posts/2023/10/19/emr-spark.html" class="post-preview card h-100"><div class="card-body"> <time data-ts="1697724000" data-df="ll" > Oct 19, 2023 </time><h4 class="pt-0 my-2">Running Recommendation Engine Spark Job on EMR</h4><div class="text-muted"><p>Abstract Amazon Elastic MapReduce (EMR) is a managed big data service that simplifies the process of processing and analyzing large datasets using popular frameworks like Apache Spark, Hadoop, and ...</p></div></div></a></article><article class="col"> <a href="/posts/2023/10/18/kineses-firehose.html" class="post-preview card h-100"><div class="card-body"> <time data-ts="1697637600" data-df="ll" > Oct 18, 2023 </time><h4 class="pt-0 my-2">Connecting Kinesis Firehose DataStream with aws-kinesis-agent to ingest Log Data into AWS S3</h4><div class="text-muted"><p>Abstract AWS Kinesis Firehose is a powerful service that enables almost real-time data streaming at scale. It simplifies the process of ingesting, transforming, and loading large volumes of data in...</p></div></div></a></article><article class="col"> <a href="/posts/2024/02/03/s3-signed-urls.html" class="post-preview card h-100"><div class="card-body"> <time data-ts="1706968800" data-df="ll" > Feb 3, 2024 </time><h4 class="pt-0 my-2">AWS S3-presigned URLs: Deep Dive and Use Cases of secure file transfers</h4><div class="text-muted"><p>Abstract One of AWS S3 features is very useful, but not so many developers and architects are familiar with it - the capability to generate presigned URLs. In this blog post, we will explore wha...</p></div></div></a></article></nav></aside><nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation"> <a href="/posts/2023/10/06/dynamo-filters.html" class="btn btn-outline-primary" aria-label="Older" ><p>DynamoDB Table Design Principles - Filtering</p></a> <a href="/posts/2023/10/18/kineses-firehose.html" class="btn btn-outline-primary" aria-label="Newer" ><p>Connecting Kinesis Firehose DataStream with aws-kinesis-agent to ingest Log Data into AWS S3</p></a></nav><footer aria-label="Site Info" class=" d-flex flex-column justify-content-center text-muted flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3 " ><p>© <time>2025</time> <a href="https://www.linkedin.com/in/roman-tsypuk">Roman Tsypuk</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >Some rights reserved.</span> <span data-bs-toggle="tooltip" data-bs-placement="top" title="2025-09-26 20:11:52 +0300 &#013;be60bb44e6416aa69b8fd68791db025be40c523c">Build version: be60bb4</span></p><p>Using the <a data-bs-toggle="tooltip" data-bs-placement="top" title="v7.2.4" href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener" >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.</p></footer></div></div><div id="search-result-wrapper" class="d-flex justify-content-center d-none"><div class="col-11 content"><div id="search-hints"><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/aws/">aws</a> <a class="post-tag btn btn-outline-primary" href="/tags/dynamodb/">dynamodb</a> <a class="post-tag btn btn-outline-primary" href="/tags/git/">git</a> <a class="post-tag btn btn-outline-primary" href="/tags/security/">security</a> <a class="post-tag btn btn-outline-primary" href="/tags/s3/">s3</a> <a class="post-tag btn btn-outline-primary" href="/tags/ecs/">ecs</a> <a class="post-tag btn btn-outline-primary" href="/tags/network/">network</a> <a class="post-tag btn btn-outline-primary" href="/tags/cli/">cli</a> <a class="post-tag btn btn-outline-primary" href="/tags/fargate/">fargate</a> <a class="post-tag btn btn-outline-primary" href="/tags/firehose/">firehose</a></div></section></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><aside aria-label="Scroll to Top"> <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button></aside></div><div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div><aside id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-animation="true" data-bs-autohide="false" ><div class="toast-header"> <button type="button" class="btn-close ms-auto" data-bs-dismiss="toast" aria-label="Close" ></button></div><div class="toast-body text-center pt-0"><p class="px-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></aside><script> (function () { const themeMapper = Theme.getThemeMapper('light', 'dark_dimmed'); const initTheme = themeMapper[Theme.visualState]; let lang = 'en';if (lang.length > 2 && !lang.startsWith('zh')) { lang = lang.slice(0, 2); } let giscusAttributes = { src: 'https://giscus.app/client.js', 'data-repo': 'tsypuk/tsypuk.github.io', 'data-repo-id': 'R_kgDOIxaFiw', 'data-category': 'General', 'data-category-id': 'DIC_kwDOIxaFi84CUSfn', 'data-mapping': 'og:title', 'data-strict' : '0', 'data-reactions-enabled': '1', 'data-emit-metadata': '0', 'data-theme': initTheme, 'data-input-position': 'top', 'data-lang': lang, 'data-loading': 'lazy', crossorigin: 'anonymous', async: '' }; let giscusNode = document.createElement('script'); Object.entries(giscusAttributes).forEach(([key, value]) => giscusNode.setAttribute(key, value) ); const $footer = document.querySelector('footer'); $footer.insertAdjacentElement("beforebegin", giscusNode); addEventListener('message', (event) => { if (event.source === window && event.data && event.data.id === Theme.ID) { const newTheme = themeMapper[Theme.visualState]; const message = { setConfig: { theme: newTheme } }; const giscus = document.getElementsByClassName('giscus-frame')[0].contentWindow; giscus.postMessage({ giscus: message }, 'https://giscus.app'); } }); })(); </script> <script> document.addEventListener('DOMContentLoaded', () => { SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<article class="px-1 px-sm-2 px-lg-4 px-xl-0"><header><h2><a href="{url}">{title}</a></h2><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div></header><p>{content}</p></article>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); }); </script>
