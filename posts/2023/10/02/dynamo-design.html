<!doctype html><html lang="en" ><head> <script async src="https://www.googletagmanager.com/gtag/js?id=G-LXECFRDHS1"></script> <script> window.dataLayer = window.dataLayer || []; function gtag() { dataLayer.push(arguments); } gtag('js', new Date()); gtag('config', 'G-LXECFRDHS1'); </script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.3.3" /><meta property="og:title" content="DynamoDB Table Design Principles - NoSQL Modeling | by Roman Tsypuk" /><meta name="author" content="Roman Tsypuk" /><meta property="og:locale" content="en" /><meta name="description" content="DynamoDB is one of the most popular NoSQL DB storages, that has amazing performance and scaling characteristics and is widely used in many designs. There is mindshift that requires us to switch from traditional RDBMS storages to NoSQL, especially in terms of Data cardinality, denormalization, non-Join queries when planning and using NoSQL storages." /><meta property="og:description" content="DynamoDB is one of the most popular NoSQL DB storages, that has amazing performance and scaling characteristics and is widely used in many designs. There is mindshift that requires us to switch from traditional RDBMS storages to NoSQL, especially in terms of Data cardinality, denormalization, non-Join queries when planning and using NoSQL storages." /><meta property="twitter:description" content="DynamoDB is one of the most popular NoSQL DB storages, that has amazing performance and scaling characteristics and is widely used in many designs. There is mindshift that requires us to switch from traditional RDBMS storages to NoSQL, especially in terms of Data cardinality, denormalization, non-Join queries when planning and using NoSQL storages." /><link rel="canonical" href="https://tsypuk.github.io/posts/2023/10/02/dynamo-design.html" /><meta property="og:url" content="https://tsypuk.github.io/posts/2023/10/02/dynamo-design.html" /><meta property="og:site_name" content="Engineer’s Notes | Roman Tsypuk" /><meta property="og:image" content="https://tsypuk.github.io/images/banners/1200/pexels-taryn-elliott-9085050.jpeg" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2023-10-02T17:00:00+03:00" /><meta name="publish_date" property="og:publish_date" content="2023-10-02T17:00:00+03:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://tsypuk.github.io/images/banners/1200/pexels-taryn-elliott-9085050.jpeg" /><meta property="twitter:title" content="DynamoDB Table Design Principles - NoSQL Modeling | by Roman Tsypuk" /><meta name="twitter:site" content="@roman_tsypuk" /><meta name="twitter:creator" content="@roman_tsypuk" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Roman Tsypuk"},"dateModified":"2025-07-20T17:36:47+03:00","datePublished":"2023-10-02T17:00:00+03:00","description":"DynamoDB is one of the most popular NoSQL DB storages, that has amazing performance and scaling characteristics and is widely used in many designs. There is mindshift that requires us to switch from traditional RDBMS storages to NoSQL, especially in terms of Data cardinality, denormalization, non-Join queries when planning and using NoSQL storages.","headline":"DynamoDB Table Design Principles - NoSQL Modeling","image":"https://tsypuk.github.io/images/banners/1200/pexels-taryn-elliott-9085050.jpeg","mainEntityOfPage":{"@type":"WebPage","@id":"https://tsypuk.github.io/posts/2023/10/02/dynamo-design.html"},"url":"https://tsypuk.github.io/posts/2023/10/02/dynamo-design.html"}</script><title>DynamoDB Table Design Principles - NoSQL Modeling | Engineer's Notes</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Engineer's Notes"><meta name="application-name" content="Engineer's Notes"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.32.2/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css"> <script src="/assets/js/dist/theme.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/en.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js,npm/tocbot@4.32.2/dist/tocbot.min.js,npm/mermaid@11.4.0/dist/mermaid.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.min.js?baseurl=&register=" ></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-LXECFRDHS1"></script> <script> document.addEventListener('DOMContentLoaded', () => { window.dataLayer = window.dataLayer || []; function gtag() { dataLayer.push(arguments); } gtag('js', new Date()); gtag('config', 'G-LXECFRDHS1'); }); </script><body><aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end"><header class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"><img src="/images/avatar/rtsypuk.jpg" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a> <a class="site-title d-block" href="/">Engineer's Notes</a><p class="site-subtitle fst-italic mb-0">Cloud, Infrastructure, Architecture, Networking</p></header><nav class="flex-column flex-grow-1 w-100 ps-0"><ul class="nav"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories.html" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags.html" class="nav-link"> <i class="fa-fw fas fa-tag"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archived_posts.html" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/roman_tsypuk.html" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a></ul></nav><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <button type="button" class="btn btn-link nav-link" aria-label="Switch Mode" id="mode-toggle"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/tsypuk" aria-label="github" target="_blank" rel="noopener noreferrer" > <i class="fab fa-github"></i> </a> <a href="https://twitter.com/roman_tsypuk" aria-label="twitter" target="_blank" rel="noopener noreferrer" > <i class="fab fa-twitter"></i> </a> <a href="https://www.linkedin.com/in/roman-tsypuk" aria-label="linkedin" target="_blank" rel="noopener noreferrer" > <i class="fab fa-linkedin"></i> </a> <a href="javascript:location.href = 'mailto:' + ['tsypuk_conf','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a></div></aside><div id="main-wrapper" class="d-flex justify-content-center"><div class="container d-flex flex-column px-xxl-5"><header id="topbar-wrapper" aria-label="Top Bar"><div id="topbar" class="d-flex align-items-center justify-content-between px-lg-3 h-100" ><nav id="breadcrumb" aria-label="Breadcrumb"> <span> <a href="/">Home</a> </span> <span>DynamoDB Table Design Principles - NoSQL Modeling</span></nav><button type="button" id="sidebar-trigger" class="btn btn-link" aria-label="Sidebar"> <i class="fas fa-bars fa-fw"></i> </button><div id="topbar-title"> Post</div><button type="button" id="search-trigger" class="btn btn-link" aria-label="Search"> <i class="fas fa-search fa-fw"></i> </button> <search id="search" class="align-items-center ms-3 ms-lg-0"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </search> <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button></div></header><div class="row flex-grow-1"><main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4"><article class="px-1" data-toc="true"><header><h1 data-toc-skip>DynamoDB Table Design Principles - NoSQL Modeling</h1><div class="post-meta text-muted"> <span> Posted <time data-ts="1696255200" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Oct 2, 2023 </time> </span> <span> Updated <time data-ts="1753022207" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Jul 20, 2025 </time> </span><div class="mt-3 mb-3"> <a href="/images/banners/1200/pexels-taryn-elliott-9085050.jpeg" class="popup img-link preview-img shimmer"><img src="/images/banners/1200/pexels-taryn-elliott-9085050.jpeg" alt="Preview Image" width="1200" height="630" loading="lazy"></a></div><div class="d-flex justify-content-between"> <span> By <em> <a href="https://www.linkedin.com/in/roman-tsypuk">Roman Tsypuk</a> </em> </span><div> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="1323 words" > <em>7 min</em> read</span></div></div></div></header><div id="toc-bar" class="d-flex align-items-center justify-content-between invisible"> <span class="label text-truncate">DynamoDB Table Design Principles - NoSQL Modeling</span> <button type="button" class="toc-trigger btn me-1"> <i class="fa-solid fa-list-ul fa-fw"></i> </button></div><button id="toc-solo-trigger" type="button" class="toc-trigger btn btn-outline-secondary btn-sm"> <span class="label ps-2 pe-1">Contents</span> <i class="fa-solid fa-angle-right fa-fw"></i> </button> <dialog id="toc-popup" class="p-0"><div class="header d-flex flex-row align-items-center justify-content-between"><div class="label text-truncate py-2 ms-4">DynamoDB Table Design Principles - NoSQL Modeling</div><button id="toc-popup-close" type="button" class="btn mx-1 my-1 opacity-75"> <i class="fas fa-close"></i> </button></div><div id="toc-popup-content" class="px-4 py-3 pb-4"></div></dialog><div class="content"><h2 id="abstract"><span class="me-2">Abstract</span><a href="#abstract" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>DynamoDB is one of the most popular NoSQL DB storages, that has amazing performance and scaling characteristics and is widely used in many designs. There is mindshift that requires us to switch from traditional RDBMS storages to NoSQL, especially in terms of Data cardinality, denormalization, non-Join queries when planning and using NoSQL storages.</p><h2 id="introduction"><span class="me-2">Introduction</span><a href="#introduction" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>The main caveat when using DynamoDB is to properly plan you Table structure and indexes in a way that will reflect to your data access patterns before the Table is created. And this is due to some limits.</p><p>First of all structures like <strong>LSIs</strong> are only possible to be created on the <strong>Table creation time</strong>, secondly DynamoDB does not support Regular DB schema Migration, that we used to have in RDBMS world (like flyway, liquibase, etc.), so ALTERing the table is not the operation that we can afford.</p><p>This post describes the variety of technics for Data Access to DynamoDB and also explains Data Access Patterns planning on the Table design stage.</p><h2 id="target-dynamodb-table-structure"><span class="me-2">Target DynamoDB Table Structure</span><a href="#target-dynamodb-table-structure" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><a href="/images/posts/dynamo/diagram.png" class="popup img-link w-100 center shimmer"><img src="/images/posts/dynamo/diagram.png" alt="diagram.png" width="100%" loading="lazy"></a></p><p>NoSQL DynamoDB Table Structure is generated using <a href="https://blog.tsypuk.github.io/multicloud-diagrams/">MultiCloud Diagrams Framework</a></p><h2 id="methodology"><span class="me-2">Methodology</span><a href="#methodology" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>All access patterns are driven by the proper defined <strong>Primary Key</strong>. Let’s go through the process of Table planning with overview of each structure. DynamoDB provides following PKs:</p><ul><li>Simple PK (partition key)<li>Compound PK (partition key &amp; sort key)</ul><h2 id="table-structure"><span class="me-2">Table Structure</span><a href="#table-structure" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><a href="/images/posts/dynamo/table.png" class="popup img-link w-60 center shimmer"><img src="/images/posts/dynamo/table.png" alt="dynamo.png" width="80%" loading="lazy"></a></p><h2 id="entity-relationship-diagram"><span class="me-2">Entity Relationship Diagram</span><a href="#entity-relationship-diagram" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><pre><code class="language-mermaid">erDiagram
  MOVIES {
    string Actor
    string Movie
    string Genre
    string Year
  }
</code></pre><h2 id="operations"><span class="me-2">Operations</span><a href="#operations" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>API level access<li>Query level access<li>Scans</ul><h2 id="api-level-get-item-operation"><span class="me-2">API level Get Item operation</span><a href="#api-level-get-item-operation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>To perform getItem API operation, we must include both existing PK and Sort Key (it is not possible to query by PK if SK exists).</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="n">dynamodb</span> <span class="o">=</span> <span class="n">boto3</span><span class="p">.</span><span class="nf">client</span><span class="p">(</span><span class="sh">'</span><span class="s">dynamodb</span><span class="sh">'</span><span class="p">)</span>
<span class="n">table_name</span> <span class="o">=</span> <span class="sh">'</span><span class="s">Movies</span><span class="sh">'</span>
<span class="c1"># Define the key(s) for the item you want to retrieve
</span><span class="n">key</span> <span class="o">=</span> <span class="p">{</span>
  <span class="sh">'</span><span class="s">Actor</span><span class="sh">'</span><span class="p">:</span> <span class="p">{</span><span class="sh">'</span><span class="s">S</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">Tom Cruise</span><span class="sh">'</span><span class="p">},</span>
  <span class="sh">'</span><span class="s">Movie</span><span class="sh">'</span><span class="p">:</span> <span class="p">{</span><span class="sh">'</span><span class="s">S</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">Top Gun</span><span class="sh">'</span><span class="p">}</span>
<span class="p">}</span>

<span class="n">response</span> <span class="o">=</span> <span class="n">dynamodb</span><span class="p">.</span><span class="nf">get_item</span><span class="p">(</span>
  <span class="n">TableName</span><span class="o">=</span><span class="n">table_name</span><span class="p">,</span>
  <span class="n">Key</span><span class="o">=</span><span class="n">key</span><span class="p">,</span>
  <span class="c1"># Add any optional parameters if needed, e.g., ProjectionExpression, ConsistentRead, etc.
</span><span class="p">)</span>
<span class="n">item</span> <span class="o">=</span> <span class="n">response</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">'</span><span class="s">Item</span><span class="sh">'</span><span class="p">)</span>
</pre></table></code></div></div><p>We have a requirement to support following data access patterns to access Table data based on Actor and Movie pairs:</p><div class="table-wrapper"><table><thead><tr><th style="text-align: left">ID<th style="text-align: left">Access Pattern<tbody><tr><td style="text-align: left">A1<td style="text-align: left">Get All movies of Actor<tr><td style="text-align: left">A2<td style="text-align: left">Get movie details with Actor and movie name<tr><td style="text-align: left">A3<td style="text-align: left">Get movies of Actor that starts with ‘A’</table></div><p>All this Access Patterns have the same PK and same SK and can be handled from initial Table key design out of the box.</p><h2 id="query"><span class="me-2">Query</span><a href="#query" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Queries are the most powerful request mechanism in DynamoDB. They allow to access the data <strong>only by PK</strong> or using compound <strong>PK and SK</strong></p><h3 id="sk-condition"><span class="me-2">SK Condition</span><a href="#sk-condition" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>When querying through <strong>(PK and SK)</strong> besides standard <strong>SK</strong> comparison with some particular value, following operations can be used:</p><ul><li>Equal to<li>Less than or equal to<li>Less than<li>Greater than or equal to<li>Greater than<li>Between<li>Begins with</ul><p>Using Queries we can handle all these Access Patterns:</p><div class="table-wrapper"><table><thead><tr><th style="text-align: left">ID<th style="text-align: left">Access Pattern<th style="text-align: left">Access BY<th style="text-align: left">Key Condition<th style="text-align: left">Filter Condition<tbody><tr><td style="text-align: left">A1<td style="text-align: left">Get All movies of Actor<td style="text-align: left">BY actor name<td style="text-align: left">“Actor = ‘Tom Cruise’”<td style="text-align: left"> <tr><td style="text-align: left">A2<td style="text-align: left">Get movie details with Actor and movie name<td style="text-align: left">BY actor name and BY movie name<td style="text-align: left">“Actor = ‘Tom Cruise’ AND EQUALS_TO(Movie, ‘Top Gun’)”<td style="text-align: left"> <tr><td style="text-align: left">A3<td style="text-align: left">Get movies of Actor that starts with ‘A’<td style="text-align: left">BY actor name and BY movie name<td style="text-align: left">“Actor = ‘Tom Cruise’ AND GREATER_THAN_OR_EQUAL_TO(Movie, ‘T’)”<td style="text-align: left"> </table></div><h3 id="projection-expression"><span class="me-2">Projection Expression</span><a href="#projection-expression" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Projections allow to limit attributes in the response, here is the example with <code class="language-plaintext highlighter-rouge">boto3</code> library to get only <code class="language-plaintext highlighter-rouge">Year</code> and <code class="language-plaintext highlighter-rouge">Genre</code> attributes from table.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre><span class="n">dynamodb</span> <span class="o">=</span> <span class="n">boto3</span><span class="p">.</span><span class="nf">client</span><span class="p">(</span><span class="sh">'</span><span class="s">dynamodb</span><span class="sh">'</span><span class="p">)</span>
<span class="n">table_name</span> <span class="o">=</span> <span class="sh">'</span><span class="s">Movies</span><span class="sh">'</span>

<span class="n">key_condition_expression</span> <span class="o">=</span> <span class="nc">Key</span><span class="p">(</span><span class="sh">'</span><span class="s">Movie</span><span class="sh">'</span><span class="p">).</span><span class="nf">eq</span><span class="p">(</span><span class="sh">'</span><span class="s">Top Gun</span><span class="sh">'</span><span class="p">)</span> <span class="o">&amp;</span> <span class="nc">Key</span><span class="p">(</span><span class="sh">'</span><span class="s">Actor</span><span class="sh">'</span><span class="p">).</span><span class="nf">begins_with</span><span class="p">(</span><span class="sh">'</span><span class="s">Tom</span><span class="sh">'</span><span class="p">)</span>
<span class="n">projection_expression</span> <span class="o">=</span> <span class="sh">'</span><span class="s">Year, Genre</span><span class="sh">'</span>

<span class="n">response</span> <span class="o">=</span> <span class="n">dynamodb</span><span class="p">.</span><span class="nf">query</span><span class="p">(</span>
  <span class="n">TableName</span><span class="o">=</span><span class="n">table_name</span><span class="p">,</span>
  <span class="n">KeyConditionExpression</span><span class="o">=</span><span class="n">key_condition_expression</span><span class="p">,</span>
  <span class="n">ProjectionExpression</span><span class="o">=</span><span class="n">projection_expression</span>
<span class="p">)</span>

<span class="n">items</span> <span class="o">=</span> <span class="n">response</span><span class="p">[</span><span class="sh">'</span><span class="s">Items</span><span class="sh">'</span><span class="p">]</span>
</pre></table></code></div></div><h2 id="lsi"><span class="me-2">LSI</span><a href="#lsi" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>We have more access patterns in requirements - to get Movies based on actor name and genre type, to get actor movies within specific range.</p><div class="table-wrapper"><table><thead><tr><th style="text-align: left">ID<th style="text-align: left">Access Pattern<tbody><tr><td style="text-align: left">A4<td style="text-align: left">Get movies Actor that have starting from ‘2020’ year<tr><td style="text-align: left">A5<td style="text-align: left">Get movies Actor that have Genre ‘Comedy’</table></div><p>Both these access patterns share the same PK as in our Table, but have distinct SK (Year and Genre). Of course, it is possible to query or scan the DataSet and apply Filtering on top, but it will be not efficient. Because DynamoDB first retrieves all data based on PK, SK and on retrieved DataSet applies the Filters Predicate.</p><p>Much more effective is to define LSI - it is an index that has same <strong>PK</strong> as a main Table but distict attribute for SK:</p><div class="table-wrapper"><table><thead><tr><th style="text-align: left">ID<th style="text-align: left">Access Pattern<th style="text-align: left">Access BY<th style="text-align: left">Key Condition<th style="text-align: left">Filter Condition<tbody><tr><td style="text-align: left">A4<td style="text-align: left">Get movies Actor that have starting from ‘2020’ year<td style="text-align: left">LSI: BY actor name and BY year<td style="text-align: left">“Actor = ‘Tom Cruise’ AND GREATER_THAN_OR_EQUAL_TO(Year, 2022)”<td style="text-align: left"> <tr><td style="text-align: left">A5<td style="text-align: left">Get movies Actor that have Genre ‘Comedy’<td style="text-align: left">LSI: BY actor name and BY Genre<td style="text-align: left">“Actor = ‘Tom Cruise’ AND EQUAL_TO(Genre, ‘Action’)”<td style="text-align: left"> </table></div><h2 id="scan"><span class="me-2">Scan</span><a href="#scan" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>This is the most expensive operation to access the Table data. We should always avoid usage of the full table scan, due to:</p><ul><li>huge negative impact to extra consumed Table Read <strong>Capacity</strong><li>too long <strong>Time</strong> of the scan operation<li>no <strong>PK</strong> or <strong>Index</strong> used in operation</ul><p>But in some cases <strong>Scan</strong> operation is used: small Table size, no possibility to introduce and consume one more GSI, etc.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="n">dynamodb</span> <span class="o">=</span> <span class="n">boto3</span><span class="p">.</span><span class="nf">client</span><span class="p">(</span><span class="sh">'</span><span class="s">dynamodb</span><span class="sh">'</span><span class="p">)</span>
<span class="n">table_name</span> <span class="o">=</span> <span class="sh">'</span><span class="s">Movies</span><span class="sh">'</span>

<span class="n">response</span> <span class="o">=</span> <span class="n">dynamodb</span><span class="p">.</span><span class="nf">scan</span><span class="p">(</span>
  <span class="n">TableName</span><span class="o">=</span><span class="n">table_name</span><span class="p">,</span>
  <span class="c1"># Add any optional parameters if needed, e.g., FilterExpression, ProjectionExpression, etc.
</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">response</span><span class="p">[</span><span class="sh">'</span><span class="s">Items</span><span class="sh">'</span><span class="p">]</span>
</pre></table></code></div></div><h2 id="gsis"><span class="me-2">GSIs</span><a href="#gsis" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Help to introduce additional Data Access Patterns that are not covered with Primary and Sort Keys, we can introduce and use GSIs.</p><h3 id="gsi-inverted-index"><span class="me-2">GSI Inverted Index</span><a href="#gsi-inverted-index" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>We will use technic called <strong>Inverted Index</strong> - PK(Actor) and SK(Movie) of Movies Table will be flipped in the GSI to PK(Movie) and SK(Actor). GSI automatically updates data when Items are added/updated/deleted in Main Table, there is no need to add extra inserts into Index Table, synchronize them with Main Table - all these are automatically provisioned.</p><p><a href="/images/posts/dynamo/gsi_flip.png" class="popup img-link w-60 center shimmer"><img src="/images/posts/dynamo/gsi_flip.png" alt="img_10.png" width="80%" loading="lazy"></a></p><p>So, after Flipping <strong>Movies &lt;-&gt; Actors</strong> Tables we have required access pattern that is using non PK attribute of Main Table:</p><div class="table-wrapper"><table><thead><tr><th style="text-align: left">ID<th style="text-align: left">Access Pattern<th style="text-align: left">Access BY<th style="text-align: left">Key Condition<th style="text-align: left">Filter Condition<tbody><tr><td style="text-align: left">A6<td style="text-align: left">Get all actors of Movie<td style="text-align: left">GSI: BY movie name<td style="text-align: left">“Movie = ‘Top Gun’”<td style="text-align: left"> </table></div><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre><td class="rouge-code"><pre><span class="n">dynamodb</span> <span class="o">=</span> <span class="n">boto3</span><span class="p">.</span><span class="nf">client</span><span class="p">(</span><span class="sh">'</span><span class="s">dynamodb</span><span class="sh">'</span><span class="p">)</span>
<span class="n">table_name</span> <span class="o">=</span> <span class="sh">'</span><span class="s">Movies</span><span class="sh">'</span>

<span class="c1"># Define the GSI name
</span><span class="n">index_name</span> <span class="o">=</span> <span class="sh">'</span><span class="s">GSI1</span><span class="sh">'</span>

<span class="c1"># Define the key condition expression and expression attribute values
</span><span class="n">key_condition_expression</span> <span class="o">=</span> <span class="nc">Key</span><span class="p">(</span><span class="sh">'</span><span class="s">Movie</span><span class="sh">'</span><span class="p">).</span><span class="nf">eq</span><span class="p">(</span><span class="sh">'</span><span class="s">Top Gun</span><span class="sh">'</span><span class="p">)</span>
<span class="n">projection_expression</span> <span class="o">=</span> <span class="sh">'</span><span class="s">Year, Genre</span><span class="sh">'</span>

<span class="c1"># Perform the query on the GSI
</span><span class="n">response</span> <span class="o">=</span> <span class="n">dynamodb</span><span class="p">.</span><span class="nf">query</span><span class="p">(</span>
  <span class="n">TableName</span><span class="o">=</span><span class="n">table_name</span><span class="p">,</span>
  <span class="n">IndexName</span><span class="o">=</span><span class="n">index_name</span><span class="p">,</span>
  <span class="n">KeyConditionExpression</span><span class="o">=</span><span class="n">key_condition_expression</span><span class="p">,</span>
  <span class="n">ProjectionExpression</span><span class="o">=</span><span class="n">projection_expression</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">items</span> <span class="o">=</span> <span class="n">response</span><span class="p">[</span><span class="sh">'</span><span class="s">Items</span><span class="sh">'</span><span class="p">]</span>
</pre></table></code></div></div><h3 id="entity-chart"><span class="me-2">Entity Chart</span><a href="#entity-chart" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Following <strong>Entity Chart</strong> are describing Table and Index structures:</p><div class="table-wrapper"><table><thead><tr><th>Entity<th>PK<th>SK<tbody><tr><td>Movies<td>Actor<td>Movie<tr><td>Movies#LSI<td>Actor<td>Year<tr><td>Movies#LSI<td>Actor<td>Genre<tr><td>Movies#GSI<td>Movie<td>Actor</table></div><p>As a result we fully provided Table structure for required access patterns with 1 LSI, 1 GSI:</p><div class="table-wrapper"><table><thead><tr><th style="text-align: left">ID<th style="text-align: left">Access Pattern<th style="text-align: left">Access BY<th style="text-align: left">Key Condition<th style="text-align: left">Filter Condition<tbody><tr><td style="text-align: left">A1<td style="text-align: left">Get All movies of Actor<td style="text-align: left">BY actor name<td style="text-align: left">“Actor = ‘Tom Cruise’”<td style="text-align: left"> <tr><td style="text-align: left">A2<td style="text-align: left">Get movie details with Actor and movie name<td style="text-align: left">BY actor name and BY movie name<td style="text-align: left">“Actor = ‘Tom Cruise’ AND EQUALS_TO(Movie, ‘Top Gun’)”<td style="text-align: left"> <tr><td style="text-align: left">A3<td style="text-align: left">Get movies of Actor that starts with ‘A’<td style="text-align: left">BY actor name and BY movie name<td style="text-align: left">“Actor = ‘Tom Cruise’ AND GREATER_THAN_OR_EQUAL_TO(Movie, ‘T’)”<td style="text-align: left"> <tr><td style="text-align: left">A4<td style="text-align: left">Get movies Actor that have starting from ‘2020’ year<td style="text-align: left">LSI: BY actor name and BY year<td style="text-align: left">“Actor = ‘Tom Cruise’ AND GREATER_THAN_OR_EQUAL_TO(Year, 2022)”<td style="text-align: left"> <tr><td style="text-align: left">A5<td style="text-align: left">Get movies Actor that have Genre ‘Comedy’<td style="text-align: left">LSI: BY actor name and BY Genre<td style="text-align: left">“Actor = ‘Tom Cruise’ AND EQUAL_TO(Genre, ‘Action’)”<td style="text-align: left"> <tr><td style="text-align: left">A6<td style="text-align: left">Get all actors of Movie<td style="text-align: left">GSI: BY movie name<td style="text-align: left">“Movie = ‘Top Gun’”<td style="text-align: left"> </table></div><h2 id="references-links"><span class="me-2">References (Links)</span><a href="#references-links" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li><a href="/posts/2023/10/04/dynamo-one-to-many.html">DynamoDB Table Design Principles - One-To-Many Relationships in NoSQL</a><li><a href="/posts/2023/10/06/dynamo-filters.html">DynamoDB Table Design Principles - Filtering</a><li><a href="https://github.com/tsypuk/samples/tree/main/dynamodb">GitHub Sample CloudFormation and NoSQL Workbench exports</a><li><a href="https://www.youtube.com/watch?v=DIQVJqiSUkE">Alex Debrie Talk on re:Invent 2019 Data modeling with Amazon DynamoDB (CMY304)</a><li><a href="https://blog.tsypuk.github.io/multicloud-diagrams/">Multicloud Diagrams</a></ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href="/categories/aws/">aws</a>, <a href="/categories/dynamodb/">dynamodb</a>, <a href="/categories/nosql/">nosql</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/aws/" class="post-tag no-text-decoration" >aws</a> <a href="/tags/dynamodb/" class="post-tag no-text-decoration" >dynamodb</a> <a href="/tags/nosql/" class="post-tag no-text-decoration" >nosql</a></div><div class=" post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2 " ><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper d-flex align-items-center"> <span class="share-label text-muted">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=DynamoDB%20Table%20Design%20Principles%20-%20NoSQL%20Modeling%20-%20Engineer's%20Notes&url=https%3A%2F%2Ftsypuk.github.io%2Fposts%2F2023%2F10%2F02%2Fdynamo-design.html" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=DynamoDB%20Table%20Design%20Principles%20-%20NoSQL%20Modeling%20-%20Engineer's%20Notes&u=https%3A%2F%2Ftsypuk.github.io%2Fposts%2F2023%2F10%2F02%2Fdynamo-design.html" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Ftsypuk.github.io%2Fposts%2F2023%2F10%2F02%2Fdynamo-design.html&text=DynamoDB%20Table%20Design%20Principles%20-%20NoSQL%20Modeling%20-%20Engineer's%20Notes" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Ftsypuk.github.io%2Fposts%2F2023%2F10%2F02%2Fdynamo-design.html" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Linkedin" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <button id="copy-link" aria-label="Copy link" class="btn small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > <i class="fa-fw fas fa-link pe-none fs-6"></i> </button> </span></div></div></div></article></main><aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted"><div class="access"><section id="access-lastmod"><h2 class="panel-heading">Recently Updated</h2><ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/posts/2025/09/26/multiagnet-n8n-bedrock.html">Orchestrating AI multi-agent infrastructure with AWS Bedrock, OpenAI and n8n</a><li class="text-truncate lh-lg"> <a href="/posts/2025/07/20/elastic-cache-vector.html">Amazon ElastiCache Redis as a Vector Embeddings Storage for Semantic Search in AWS Community Blog posts</a><li class="text-truncate lh-lg"> <a href="/posts/2025/09/17/duckdb-s3.html">Running analytics queries from your machine with Zero-BigData stack needed on top of AWS S3(compressed JSON, Parquet, csv) or other DataSources</a><li class="text-truncate lh-lg"> <a href="/posts/2023/10/02/dynamo-design.html">DynamoDB Table Design Principles - NoSQL Modeling</a><li class="text-truncate lh-lg"> <a href="/posts/2023/10/04/dynamo-one-to-many.html">DynamoDB Table Design Principles - One-To-Many Relationships in NoSQL</a></ul></section><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/aws/">aws</a> <a class="post-tag btn btn-outline-primary" href="/tags/dynamodb/">dynamodb</a> <a class="post-tag btn btn-outline-primary" href="/tags/git/">git</a> <a class="post-tag btn btn-outline-primary" href="/tags/security/">security</a> <a class="post-tag btn btn-outline-primary" href="/tags/s3/">s3</a> <a class="post-tag btn btn-outline-primary" href="/tags/ecs/">ecs</a> <a class="post-tag btn btn-outline-primary" href="/tags/network/">network</a> <a class="post-tag btn btn-outline-primary" href="/tags/cli/">cli</a> <a class="post-tag btn btn-outline-primary" href="/tags/fargate/">fargate</a> <a class="post-tag btn btn-outline-primary" href="/tags/firehose/">firehose</a></div></section></div><div class="toc-border-cover z-3"></div><section id="toc-wrapper" class="invisible position-sticky ps-0 pe-4 pb-4"><h2 class="panel-heading ps-3 pb-2 mb-0">Contents</h2><nav id="toc"></nav></section></aside></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4"><aside id="related-posts" aria-labelledby="related-label"><h3 class="mb-4" id="related-label">Further Reading</h3><nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><article class="col"> <a href="/posts/2023/10/06/dynamo-filters.html" class="post-preview card h-100"><div class="card-body"> <time data-ts="1696600800" data-df="ll" > Oct 6, 2023 </time><h4 class="pt-0 my-2">DynamoDB Table Design Principles - Filtering</h4><div class="text-muted"><p>Abstract We will continue exploring different technics that allow to extend Access Patterns to a Single Table. Target DynamoDB Table Structure NoSQL DynamoDB Table Structure is generated usi...</p></div></div></a></article><article class="col"> <a href="/posts/2023/10/04/dynamo-one-to-many.html" class="post-preview card h-100"><div class="card-body"> <time data-ts="1696428000" data-df="ll" > Oct 4, 2023 </time><h4 class="pt-0 my-2">DynamoDB Table Design Principles - One-To-Many Relationships in NoSQL</h4><div class="text-muted"><p>Abstract In Relational Database we used to have single Entity per Table, build relationships between them and assign constrains like Foreign Keys. In NoSQL DynamoDB world this became an Antipatter...</p></div></div></a></article><article class="col"> <a href="/posts/2024/09/21/aws-nuke.html" class="post-preview card h-100"><div class="card-body"> <time data-ts="1726869600" data-df="ll" > Sep 21, 2024 </time><h4 class="pt-0 my-2">AWS-nuke controlled resources cleanup in multiple aws accounts</h4><div class="text-muted"><p>AWS-Nuke is an open-source tool, designed to automate the removal of AWS resources from an account. It can be used to quickly and safely delete all resources in a given AWS account, or it can be cu...</p></div></div></a></article></nav></aside><nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation"> <a href="/posts/2023/09/13/pfsense-client-vpn.html" class="btn btn-outline-primary" aria-label="Older" ><p>Integrating AWS Client VPN with pfSense (most popular OpenSource Router and Firewall)</p></a> <a href="/posts/2023/10/04/dynamo-one-to-many.html" class="btn btn-outline-primary" aria-label="Newer" ><p>DynamoDB Table Design Principles - One-To-Many Relationships in NoSQL</p></a></nav><footer aria-label="Site Info" class=" d-flex flex-column justify-content-center text-muted flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3 " ><p>© <time>2025</time> <a href="https://www.linkedin.com/in/roman-tsypuk">Roman Tsypuk</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >Some rights reserved.</span> <span data-bs-toggle="tooltip" data-bs-placement="top" title="2025-09-26 20:11:52 +0300 &#013;be60bb44e6416aa69b8fd68791db025be40c523c">Build version: be60bb4</span></p><p>Using the <a data-bs-toggle="tooltip" data-bs-placement="top" title="v7.2.4" href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener" >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.</p></footer></div></div><div id="search-result-wrapper" class="d-flex justify-content-center d-none"><div class="col-11 content"><div id="search-hints"><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/aws/">aws</a> <a class="post-tag btn btn-outline-primary" href="/tags/dynamodb/">dynamodb</a> <a class="post-tag btn btn-outline-primary" href="/tags/git/">git</a> <a class="post-tag btn btn-outline-primary" href="/tags/security/">security</a> <a class="post-tag btn btn-outline-primary" href="/tags/s3/">s3</a> <a class="post-tag btn btn-outline-primary" href="/tags/ecs/">ecs</a> <a class="post-tag btn btn-outline-primary" href="/tags/network/">network</a> <a class="post-tag btn btn-outline-primary" href="/tags/cli/">cli</a> <a class="post-tag btn btn-outline-primary" href="/tags/fargate/">fargate</a> <a class="post-tag btn btn-outline-primary" href="/tags/firehose/">firehose</a></div></section></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><aside aria-label="Scroll to Top"> <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button></aside></div><div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div><aside id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-animation="true" data-bs-autohide="false" ><div class="toast-header"> <button type="button" class="btn-close ms-auto" data-bs-dismiss="toast" aria-label="Close" ></button></div><div class="toast-body text-center pt-0"><p class="px-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></aside><script> (function () { const themeMapper = Theme.getThemeMapper('light', 'dark_dimmed'); const initTheme = themeMapper[Theme.visualState]; let lang = 'en';if (lang.length > 2 && !lang.startsWith('zh')) { lang = lang.slice(0, 2); } let giscusAttributes = { src: 'https://giscus.app/client.js', 'data-repo': 'tsypuk/tsypuk.github.io', 'data-repo-id': 'R_kgDOIxaFiw', 'data-category': 'General', 'data-category-id': 'DIC_kwDOIxaFi84CUSfn', 'data-mapping': 'og:title', 'data-strict' : '0', 'data-reactions-enabled': '1', 'data-emit-metadata': '0', 'data-theme': initTheme, 'data-input-position': 'top', 'data-lang': lang, 'data-loading': 'lazy', crossorigin: 'anonymous', async: '' }; let giscusNode = document.createElement('script'); Object.entries(giscusAttributes).forEach(([key, value]) => giscusNode.setAttribute(key, value) ); const $footer = document.querySelector('footer'); $footer.insertAdjacentElement("beforebegin", giscusNode); addEventListener('message', (event) => { if (event.source === window && event.data && event.data.id === Theme.ID) { const newTheme = themeMapper[Theme.visualState]; const message = { setConfig: { theme: newTheme } }; const giscus = document.getElementsByClassName('giscus-frame')[0].contentWindow; giscus.postMessage({ giscus: message }, 'https://giscus.app'); } }); })(); </script> <script> document.addEventListener('DOMContentLoaded', () => { SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<article class="px-1 px-sm-2 px-lg-4 px-xl-0"><header><h2><a href="{url}">{title}</a></h2><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div></header><p>{content}</p></article>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); }); </script>
